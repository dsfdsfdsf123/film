<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>电影动态信息管理</title>
    <link rel="stylesheet" type="text/css" href="/static/jquery-easyui-1.3.3/themes/default/easyui.css" />
    <link rel="stylesheet" type="text/css" href="/static/jquery-easyui-1.3.3/themes/icon.css" />
    <script type="text/javascript" src="/static/jquery-easyui-1.3.3/jquery.min.js"></script>
    <script type="text/javascript" src="/static/jquery-easyui-1.3.3/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="/static/jquery-easyui-1.3.3/locale/easyui-lang-zh_CN.js"></script>

</head>
<body style="margin:1px">
    <table id="dg" title="电影动态信息管理" class="easyui-datagrid" fitColumns="true" pagination="true" rownumbers="true" url="/admin/webSiteInfo/list" fit="true" toolbar="#tb">
        <thead>
            <tr>
                <th field="cb" checkbox="true" align="center"></th>
                <th field="id" checkbox="200" align="center">编号</th>
                <th field="filmName" checkbox="200" align="center" formatter="formatFilmName">电影名称</th>
                <th field="webSiteName" checkbox="200" align="center" formatter="formatWebSiteName">网址名称</th>
                <th field="info" checkbox="200" align="center">动态信息</th>
                <th field="url" checkbox="200" align="center">具体网址</th>
                <th field="publishDate" checkbox="200" align="center">发布日期</th>
            </tr>
        </thead>
    </table>
    <div id="tb">
        <div>
            <a href="javascript:openWebSiteInfoAddDialog()" class="easyui-linkbutton" iconCls="icon-add" plain="true">添加</a>
            <a href="javascript:openWebSiteInfoModifyDialog()" class="easyui-linkbutton" iconCls="icon-edit" plain="true">修改</a>
            <a href="javascript:deleteWebSiteInfo()" class="easyui-linkbutton" iconCls="icon-remove" plain="true">删除</a>
        </div>

        <div>
            &nbsp;电影动态信息&nbsp; <input type="text" id="s_info" name="s_info" size="20" onkeydown="if (event.keyCode==13) searchWebSiteInfo()" />
            <a href="javascript:searchWebSiteInfo()" class="easyui-linkbutton" iconCls="icon-search" plain="true">搜索</a>
        </div>
    </div>
    <script type="text/javascript">
        var url;

        function formatFilmName(val,row) {
            return row.film.name;
        }
        function formatWebSiteName(val,row) {
            return row.webSite.name+"&nbsp;("+row.webSite.url+")";
        }
        function searchWebSiteInfo() {
            $("#dg").datagrid("load",{
                "info":$("#s_info").val()
            });
        }

        function deleteWebSiteInfo() {
            var selectRows = $("#dg").datagrid("getSelections");
            if(selectRows.length == 0){
                $.messager.alert("请选择","要删除的数据");
            }else{
                var strIds = [];
                for (var i=0;i<selectRows.length;i++){
                    strIds.push(selectRows[i].id);
                }
                var ids = strIds.join(",");
                $.messager.confirm("系统提示","您确定删除这<strong color='red'>"+selectRows.length+"</strong>条数据吗?",function (r) {
                    if (r){
                        $.post("/admin/webSiteInfo/delete",{ids:ids},function (result) {
                            if (result.success){
                                $.messager.alert("系统提示","删除成功");
                                $("#dg").datagrid("reload");
                            } else{
                                $.messager.alert("系统提示","删除失败，请联系管理员");
                            }
                        },"json");
                    }
                });
            }
        }
    </script>
</body>
</html>